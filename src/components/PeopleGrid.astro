---
import PersonCard from "./PersonCard.astro";
import "../styles/components/people-grid.css";

export interface Props {
    persons: {
        image: string;
        name: string;
        title: string;
    }[];
    gap?: string;
}

const { persons, gap = "1rem" } = Astro.props;
---

<section
    class="people-grid"
    style={`--people-grid-gap: ${gap}`}
    data-people={persons.length}
    aria-label="People"
>
    {
        persons.map((person, index) => (
            <div class="person-wrapper" data-index={index}>
                <PersonCard
                    image={person.image}
                    name={person.name}
                    title={person.title}
                />
            </div>
        ))
    }
</section>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const grid = document.querySelector(".people-grid");
        if (!grid) return;

        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        const wrappers =
                            grid.querySelectorAll(".person-wrapper");
                        wrappers.forEach((wrapper) => {
                            wrapper.classList.add("animate");
                        });
                        observer.unobserve(entry.target);
                    }
                });
            },
            { threshold: 0.1 },
        );

        observer.observe(grid);
    });
</script>
